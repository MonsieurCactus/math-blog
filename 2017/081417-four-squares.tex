\documentclass[12pt]{article}
%Gummi|065|=)
\usepackage{amsmath, amsfonts, amssymb}
\usepackage[margin=0.5in]{geometry}
\usepackage{xcolor}
\usepackage{graphicx}

\usepackage{pifont}
\usepackage{amsmath}

\newcommand{\off}[1]{}
\DeclareMathSizes{20}{30}{20}{18}

\newcommand{\two }{\sqrt[3]{2}}
\newcommand{\four}{\sqrt[3]{4}}
\newcommand{\red}{\begin{tikz}[scale=0.25]
\draw[fill=red, color=red] (0,0)--(1,0)--(1,1)--(0,1)--cycle;\end{tikz}}
\newcommand{\blue}{\begin{tikz}[scale=0.25]
\draw[fill=blue, color=blue] (0,0)--(1,0)--(1,1)--(0,1)--cycle;\end{tikz}}
\newcommand{\green}{\begin{tikz}[scale=0.25]
\draw[fill=green, color=green] (0,0)--(1,0)--(1,1)--(0,1)--cycle;\end{tikz}}

\newcommand{\sq}[3]{\draw[#3] (#1,#2)--(#1+1,#2)--(#1+1,#2+1)--(#1,#2+1)--cycle;}
\newcommand{\linebrk}{----------------------------------------------------------------------------------------------------------------------------------}


\usepackage{tikz}

\newcommand{\susy}{{\bf Q}}
\newcommand{\RV}{{\text{R}_\text{V}}}

\title{Tutorial : Sum of Four Squares}
\date{}
\begin{document}

\fontfamily{qag}\selectfont \fontsize{12.5}{15}\selectfont

\maketitle

\noindent Zagier's proof that every integer is the sum of 4 perfect squares, is scattered in various parts of his first notes. 
$$ n = a^2 + b^2 + c^2 + d^2 \text{ for } n \geq 0$$
Here we try to present a different narrative.  Number Theory and Modular forms are separate fields of Mathematics, advancing in their own way, but they have many things in common. It's hard to create Number Theory results, that use modular forms and still look elemenatary. \\ \\
\textbf{Step \# 1} Observe the coefficients of $\theta(z)^4$ are the number of ways to express $n$ as the sum of four squares:
$$ \theta(z)^4 = \left[ \sum_{n \in \mathbb{Z}}  q^{n^2} \right]^4 = \sum_{n \geq 0}\; 
\#\Big\{ (a,b,c,d): a^2 + b^2 + c^2 + d^2 = n  \Big\} \; q^n
\equiv \sum_{n \geq 0} r_4(n) q^n $$
This is a modular form of weight $2$ on $\Gamma_0(4)$ which is generated by $z \mapsto z + 1$ and $z \mapsto  - \frac{1}{4z}$. \\
The full group $\text{SL}(2, \mathbb{Z})$ acts on several theta functions at once turning them into each other. \\ \\
This action is closely related to Poisson summation.  For $f \in \mathcal{S}(\mathbb{R})$ the Schwartz class:
$$ \sum_{n \in \mathbb{Z}} f(n) = \sum_{n \in \mathbb{Z}} \hat{f}(n) $$
In our case, $f(z) = q^{z^2}$, for $z \in i \mathbb{R}$ (and by analytic continuation\footnote{What properties of $\theta$ were used to define such a continuation?} to all of $\mathbb{C}$). \\ \\
\textbf{Step \# 2} The space of modular forms of weight $2$ on $\mathbb{H}/\Gamma_0(4)$ is at most two-dimensional. \\ \\
This is another whopper.


\newpage

\noindent \textbf{Step \#3} We find a basis of $M_2 \big(\Gamma_0(4)\big)$.  The two startfunctions do span:
\begin{eqnarray*}
\mathbb{G}_2 (z) &=& - \frac{1}{24} + \sum_{n=1}^\infty \sigma_1(n) \, q^n  = - \frac{1}{24} + q + 3q^2 + 4q^3 + 7q^4 + 6q^5 + \dots \\
G_2(z) &=& - 4\pi^2 \mathbb{G}_2(z) = \frac{1}{2} \sum_{n \neq 0} \frac{1}{n^2}  + \frac{1}{2} \sum_{m \neq 0} \sum_{n \in \mathbb{Z}} \frac{1}{(mz+n)^2} \\
\end{eqnarray*}
This is related to Eisenstein series by a factor of $\zeta$.  If $k > 2$ we'd have:
\begin{eqnarray*} G_k(z) &=& \zeta(k) E_k(z) \\ \\
G_k(z) &=&  \frac{1}{2} \sum_{(m,n) \neq (0,0)} \frac{1}{(mz+n)^2}  \\
 E_k(z) &=& \sum_{\gamma \in \Gamma_\infty \backslash \Gamma_1 } 1\big|_k \gamma 
 = \frac{1}{2} \sum_{(c,d)=1} \frac{1}{(cz+d)^k}
\end{eqnarray*}
As $k \to 2$ did the extra terms just magically appear?  Zagier just says for $k > 2$ define it this way, for $k= 2$ define this special way.
$$ \mathbb{G}^*_2(z) = G_2(z) - \frac{\pi}{2y} $$
There's lot of exciting regularization issues going on here\dots letting $k = 2 + \epsilon$. \\ \\
Here are three modular forms of weight $2$ on $\Gamma_0(4)$, that are \textbf{not} holomorphic:
$$ \mathbb{G}^*_2(z), \mathbb{G}^*_2(2z) , \mathbb{G}^*_2(4z) $$
Here are two holomorphic forms that's don't have the $y$-term.
$$  \mathbb{G}^*_2(z) -  2\,\mathbb{G}^*_2(2z)  \; , \;  \mathbb{G}^*_2(2z) -  2\mathbb{G}^*_2\,(4z) $$
and now our modular form of interest $\theta(z)^4$ fits into this space $M_2(\Gamma_0(4))$ as well.  By search:
$$ \theta(z)^4 = 8 \big( \, \mathbb{G}^*_2(z) -  2\,\mathbb{G}^*_2(2z)  \, \big) + 16 \big( \,\mathbb{G}^*_2(2z) -  2\mathbb{G}^*_2\,(4z) \,\big)  $$
This is essentially the \textbf{pigeonhole principle}. This turns a formula for the divisor function:
$$ d_4(n) = 8 \,\sigma_1(n) - 32 \sigma_1\, (n/4) $$
It's likely there are many more elementary identities of this kind waiting to be discovered. 

\newpage

\noindent What's so great, we have incorporated all the basic theorems into a single proof except for: \\ \\ \\
\textbf{Theorem }Let $f(z)$ be a cusp form of weight $k$ on $\Gamma_1 = \mathrm{SL}(2, \mathbb{Z})$.  E.g. let $f(z) = \sum a_n \, q^n$.  Then:
$$ a_n \leq C \, \sqrt{n^k}  $$
for $n \geq 0$.  The constant $C$ can change with the $f$ (does not depend on $n$). \\ \\ \\
The problem is our function $\theta(z)^4 = {\color{green!50!blue}\mathbf{1}} + 8 \, q + \dots $ is not cusp.  However, maybe we can find other related theta functions which have series expansion $\sum a_n \, q^n$ with $a_0 = 0$.  Let's proof this coefficients theorem \\ \\
\textbf{Proof} We have the Fourier transform formula, integrating across a horocycle:
$$ a_n = e^{2\pi n y} \int_0^1 f(x + iy) e^{- 2\pi i \, n x} \; dx  $$
The geometry of the region dictates that we should have a bound for $f$:
$$ \big|f(z)\big| < c \, y^{-k/2} $$
Therefore $|a_n| <  c  \, y^{-k/2} \, e^{2\pi \ ny } $ A small leap here, if we set $y \asymp \frac{1}{n}$ we should have:
$$ |a_n| < \big( c \, e^{2\pi} \big) \, n^{k/2} $$
This is the bound that Hecke proved. \\ \\
{\color{red!50!green}Exercise} \\ 
$f$ is cusp $\leftrightarrow$ $f(z) = O(q)$ with $|q| = e^{-2\pi y }$ and $y \to \infty$.  \hfill This just says that $q \to 0$ is a cusp. \\ \\ \\
\textbf{Return to Step \#2}: Let $f(z)$ be a modular form of weight $k$.  Then
$$ \text{ord}_\infty (f) + \sum_{z \in \Gamma_0(4)}  \frac{1}{e} \, \text{ord} (f) = \frac{k}{12} $$ \dots

\newpage

\noindent This would be the contour for $\Gamma_0(1) = \text{SL}(2, \mathbb{Z}) \backslash \mathbb{H}$ \\\\
How do we compute the volume of congruence groups?\\
\includegraphics{modular-01.png} \\ \\
In the case of $\Gamma_0(4)$ the region is exactly 6 times as large (as found by the proposition):
$$ \text{Vol} \big( \Gamma_0(4) \backslash \mathbb{H}\big) = 6 \times \text{Vol} ( \text{SL}(2, \mathbb{Z}) \backslash \mathbb{H}) $$
It would be reasonable to try to draw the region bounced by the two maps $z \mapsto z + 1$ and $z \mapsto - \frac{1}{4z}$.  We know the result should be contained in an infinite cylinder, but the second map cuts the region even more.  It's not hard, but a discussion is not readily available \\ 
\includegraphics{modular-02.png} \\ \\
\textbf{Proposition}\footnote{For $N = 4$ this would give n answer of $6$.  The above picture is the region for $\Gamma(4)$ not $\Gamma_0(4)$. } The coset representatives of $\Gamma_0(N)$ are in 1-1 bijection with $\mathbb{P}^1(\mathbb{Z}/ N \mathbb{Z})$. 


\newpage

\noindent Consulting a textbook: \\ \\
\textbf{Proposition} The modular group at level $N$ is defined by:
$$ \Gamma_0(N) \equiv \left\{  \left( \begin{array}{cc}
a & b \\ c & d \end{array} \right) : c \equiv 0 \pmod N \right\}  $$
In our case $N = 4$.  We are trying to draw: $\mathcal{F} = \mathbb{H}/\Gamma_0(4)$.  If I pick two generators:
$$ z \mapsto z + 1,\; z \mapsto - \tfrac{1}{4z} \in \Gamma_0(4) \subseteq \text{PSL}_2(\mathbb{Z}) $$
There are two ways to reason about the fundamental domain, $\mathcal{F}$.
\begin{itemize}
\item As a subgroup, we can compute the index $[\Gamma_0(4):\text{PSL}_2(\mathbb{Z})] \in \mathbb{N}$ in fact, there is a neat formula for that.  The fundamental region for $\Gamma_0(4)$ will be the union of copies of the regon for $\text{SL}_2(\mathbb{Z})$.
\item I could try, from scratch, to draw the images of $z=i$ for every possible combination of $S: z \mapsto - \frac{1}{4z}$ and $T: z \mapsto z+1$.  Then, maybe I can find the Voronoi polygon of one of the points in the hyperbolic plane $\mathbb{H}$.  This is a good skill to have.
\end{itemize} 
These two methods will give different fundmamental domains.\\
\includegraphics{modular-03.png} \\ 
This is not the fundamental domain but it is kind of awesome.  It is the set of images:
$$ \left\langle S:z \mapsto \frac{4}{z} ,\;  T:z \mapsto z + 1\right\rangle \, i \in \mathbb{H} $$
The plot after using the correct map is a it calmer, but it raised a question that the fundamental domain was an infinite-sided polygon.  And that's something I'd rather not check.

\newpage

\noindent Or it could be a triangle.  It's a different triangle from the one you find in $\mathbb{H}/SL(2, \mathbb{Z})$ \\
\includegraphics[width=4.5in]{modular-04.png} \\ 
It is an infinite triangle, but it has finite hyperbolic area.  By Gauss-Bonnet theorem, or whatever:
$$ \text{Vol}\big(\mathbb{H}/\Gamma_0(4)\big) = \int_{-1/2}^{1/2} \left[ \int^\infty_{\sqrt{1/4-x^2}} \frac{dy}{y^2} \right]dx =  \int_{-1/2}^{1/2}  \frac{dx}{\sqrt{1/4 - x^2}}
= 2 \times tan^{-1}(x)\bigg|_{-\pi/2}^{\pi/2} = 2\pi = 6 \times \frac{\pi}{3}$$
This really is six times the area of the $SL(2, \mathbb{Z})$ fundamental domain suggesting we are correct.  \\ \\
\textbf{Next Time}: using this proof (or another) we hint at equidistribution of the 4-squares points, connections to Hopf fibration, Davenport's geometry of number's proof, and how these things should behave over the Adeles, $\mathbb{A}$.  That the proof uses the Weil conjectures suggests we should reap the many intermediate results first.

\vfill

\begin{thebibliography}{}


\item Don Zagier \textbf{Elliptic Modular Forms and their Applications} \\ \texttt{https://doi.org/10.1007/978-3-540-74119-0\_1}

\item Jan Bruinier, Gerard Geer, G\"{u}nter Harder, Don Zagier. \\ \textbf{The 1-2-3 of Modular Forms} (Universitext) Springer, 2008.

\item Anton Deitmar \textbf{Automorphic Forms} (Universitext) Springer, 2013.

\item A000118:\textbf{	Number of ways of writing $n$ as a sum of $4$ squares; also theta series of lattice $\mathbb{Z}^4$} Onine Encyclopedia of Integer Sequences \texttt{https://oeis.org/A000118}

\item Oliver Sargent, Uri Shapira \textbf{Dynamics on the space of 2-lattices in 3-space} \texttt{arXiv:1708.04464}

\end{thebibliography}

\newpage

\noindent \textbf{8/17}  We need to get a move-on, I'm afraid.  Here's a sentence from a paper of an old colleague of mine, that I'm considering reading.
\begin{quotation} \noindent Let $\pi$ traverse a sequence of cuspidal automorphic representations of $\text{GL}_2$ with large prime level and bounded infinity type.
\end{quotation}
Number Theory at the professional level has become so modern I can no longer discern it's elementary counterparts.  Think about it, we had enough trouble writing down the boundary of the region $\mathbb{H}/\Gamma_0(4)$ we may also have trouble understandiong a group like:
$$ \text{SL}_2(\mathbb{Q})\backslash \text{SL}_2(\mathbb{A})/\text{SL}_2(\hat{\mathbb{Z}})$$
so while a textbook like Dietmar or Bump may put down all the foundations, all the ``elementary" parts (i.e. the good parts)  are left as exercises to the reader. \\ \\
We need more modular forms.  Our resources are:
\begin{itemize}
\item Eisenstein series $\subseteq$ Poincar\'{e} series
\item Theta functions
\item Hecke Eigenfunctions
\item Maa{\ss} waveforms 
\end{itemize}
Here is the definition I found for theta function by my friend.
\begin{quotation}
Let $\rho_\psi: \mathcal{S}(\mathbb{A})\to \mathcal{S}(\mathbb{A})$ be the Weil representation attached to $\psi\in \text{Mp}_2(\mathbb{A})$ (acting on Adelic Schwartz space).  For $\phi \in \rho_\psi$, the ``elementary" theta function:
$$ \theta(\phi): \text{SL}_2(F)\backslash \text{Mp}_2(\mathbb{A}) \to \mathbb{C} $$
is an automorphic form, we can even write down a nice concrete formula for it:
$$\theta(\phi)(g) := \sum_{\alpha \in F} \Big(\rho_\psi(g)\Big)(\alpha) $$
\end{quotation}
This is a far cry from $\theta(z) = \sum_{n \in \mathbb{Z}} q^{n^2}$ but at least this style of writing makes the symmetry very very clear.  Perhaps. \\ \\
Obviously, Paul Nelson and his teachers are correct.  I just wouldn't be able to tell you.\footnote{We will go back a few decades and examine space of modular forms constructed by Goro Shimura and some newer constructions by Don Zagier. Orthogonal to all mathematics, these papers were written in the 1970's and type-written in the 1970's.  These papers are written an a rather streamlined, mechanical style that makes it difficult to pick out the more salient features. They are very difficult to read: both the symbols are difficult to read and the mathematics is challenging.}   

\newpage
\noindent Let $n \in \mathbb{Z}$ be a positive integer, and $A$ is a positive definite $n \times n$ matrix\footnote{The term ``matrix" can be thought of a short-hand for the algebra spanned by $e_i \otimes e_i^*$ with $e_i \in V$ and $e_i^* \in V^*$.  There should be other algebras defined with other multiplications and they are written in this algebraic way without any matrix shorthand.  We should invent our own!} with entires in $\mathbb{R}$.  \\ \\
Let $x \in \mathbb{R}^n$ and $P$ be a \textbf{spherical function} $P: \mathbb{R}^n \to \mathbb{C}$ with 
$$ P(x) = \left\{ \begin{array}{lcc} 
\text{constant} & \text{if} & \nu=0  \\ \\
\displaystyle \sum_q \beta_q \;( \, q^T \, A \, x \,)^\nu & \text{if} & \nu>0
\end{array} \right. $$
These vector $q$ should have $q^T A q = 0$ if $\nu > 1$. I could type this $\langle q | A | q \rangle = 0$. Define $\theta(z;P)$ with
$$ \theta(z;P) = \sum_{m \in h + N \mathbb{Z}^n} P(m) \cdot e 
\Big( \tfrac{1}{2N^2} \cdot z \cdot (m^T A m)  \Big) $$
Duke calls this $u$ instead of $P$.  It looks good that spherical harmonics $u \in L^2[S^n]$ should count as ``spherical functions" in this definition. \\ \\
Despite being written in 1973, the idea of summing over close-to-random vectors $q \in S^n $ has a very modern flair to it.  The care in which Shimura is writing suggests his modular form construction does not always ``work".\footnote{It works!  It doesn't work!  This phrases changes every time we use it.  Yet, this is our way of connecting all the things\dots}

\end{document}